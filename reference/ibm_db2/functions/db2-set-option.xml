<?xml version="1.0" encoding="utf-8"?>
<!-- EN-Revision: 96c9d88bad9a7d7d44bfb7f26c226df7ee9ddf26 Maintainer: rjhdby Status: ready -->
<!-- Reviewed: no -->
<!-- $Revision$ -->
<refentry xmlns="http://docbook.org/ns/docbook" xml:id="function.db2-set-option">
 <refnamediv>
  <refname>db2_set_option</refname>
  <refpurpose>Установка опции для соединения или ресурса оператора</refpurpose>
 </refnamediv>
 <refsect1 role="description">
  &reftitle.description;
  <methodsynopsis>
   <type>bool</type><methodname>db2_set_option</methodname>
   <methodparam><type>resource</type><parameter>resource</parameter></methodparam>      
   <methodparam><type>array</type><parameter>options</parameter></methodparam>
   <methodparam><type>int</type><parameter>type</parameter></methodparam>
  </methodsynopsis>
  <para>
   Установка опции для соединения или ресурса оператора. Для
   ресурса результирующего набора опции задавать нельзя.
  </para>
 </refsect1>
 <refsect1 role="parameters">
  &reftitle.parameters;
  <para>
   <variablelist>
    <varlistentry>
     <term><parameter>resource</parameter></term>
     <listitem>
      <para>
       Корректный ресурс оператора, полученный из
       <function>db2_prepare</function> или же ресурс 
       соединения, полученный из
       <function>db2_connect</function> или
       <function>db2_pconnect</function>.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><parameter>options</parameter></term>
     <listitem>
      <para>
       Ассоциативный массив, содержащий опции, 
       соответствующие ресурсу. Этот параметр можно 
       использовать для изменения режима автоподтверждения
       транзакций, типа курсора и задания регистра имен 
       столбцов (нижний, верхний, как есть) в результирующем
       наборе.
       <variablelist>
        <varlistentry>
         <term><parameter>autocommit</parameter></term>
         <listitem>
          <para>
           <literal>DB2_AUTOCOMMIT_ON</literal> - включить 
           режим автоподтверждения транзакций для заданного
           соединения.
          </para>
          <para>
           <literal>DB2_AUTOCOMMIT_OFF</literal> - отключить 
           режим автоподтверждения транзакций для заданного
           соединения.
          </para>
         </listitem>
        </varlistentry>
        <varlistentry>
         <term><parameter>cursor</parameter></term>
         <listitem>
          <para>
           <literal>DB2_FORWARD_ONLY</literal> - задать 
           тип курсора "только вперед". Это тип по умолчанию
           и он поддерживается всеми базами данных.
          </para>
          <para>
           <literal>DB2_SCROLLABLE</literal> - задать тип
           курсора как "перематываемый". Данный тип курсора
           позволяет получать доступ к произвольным строкам
           результирующего набора и доступен только для
           IBM DB2 Universal Database.
          </para>
         </listitem>
        </varlistentry>
        <varlistentry>
         <term><parameter>binmode</parameter></term>
         <listitem>
          <para>
           <literal>DB2_BINARY</literal> - определяет, что
           бинарные данные будут возвращены как есть. Это
           режим по умолчанию, он равносилен заданию
           <literal>ibm_db2.binmode=1</literal> в &php.ini;.
          </para>
          <para>
           <literal>DB2_CONVERT</literal> - определяет, что
           бинарные данные будут сконвертированы в
           шестнадцатеричное предстваление. Равносильно
           заданию <literal>ibm_db2.binmode=2</literal> в
           &php.ini;.
          </para>
          <para>
           <literal>DB2_CONVERT</literal> - определяет, что
           бинарные данные будут сконвертированы в
           &null;. Равносильно заданию
           <literal>ibm_db2.binmode=3</literal> в &php.ini;.
          </para>
         </listitem>
        </varlistentry>
        <varlistentry>
         <term><parameter>db2_attr_case</parameter></term>
         <listitem>
          <para>
           <literal>DB2_CASE_LOWER</literal> - определяет, 
           что имена столбцов будут возвращены в нижнем
           регистре. 
          </para>
          <para>
           <literal>DB2_CASE_UPPER</literal> - определяет, 
           что имена столбцов будут возвращены в верхнем
           регистре. 
          </para>
          <para>
           <literal>DB2_CASE_NATURAL</literal> - определяет, 
           что имена столбцов будут возвращены как есть. 
          </para>
         </listitem>
        </varlistentry>
        <varlistentry>
         <term><parameter>deferred_prepare</parameter></term>
         <listitem>
          <para>
           <literal>DB2_DEFERRED_PREPARE_ON</literal> - 
           включает отложенную подготовку ресурса оператора.
          </para>
          <para>
           <literal>DB2_DEFERRED_PREPARE_OFF</literal> - 
           выключает отложенную подготовку ресурса оператора.
          </para>
         </listitem>
        </varlistentry>                
       </variablelist>
      </para>
      <para>
       Следующие новые опции i5/OS доступны в ibm_db2 версии
       1.5.1 и выше. Эти опции доступны только если PHP и
       ibm_db2 запущены на системе i5.
       <variablelist>
        <varlistentry>
         <term><parameter>i5_fetch_only</parameter></term>
         <listitem>
          <para>
           <literal>DB2_I5_FETCH_ON</literal> - курсоры
           могут быть только для чтения и не могут 
           использоваться для позиционирования при
           DELETE или UPDATE. Является поведением по
           умолчанию, только если переменная окружения
           <literal>SQL_ATTR_FOR_FETCH_ONLY</literal> 
           не установлена в <literal>SQL_FALSE</literal>.
          </para>
          <para>
           <literal>DB2_I5_FETCH_OFF</literal> - курсоры 
           можно использовать для позиционирования при
           DELETE или UPDATE.
          </para>
         </listitem>
        </varlistentry>
       </variablelist>
      </para>
      <para>
       Следующие новые опции доступны в ibm_db2 версии 
       1.8.0 и выше.
       <variablelist>
        <varlistentry>
         <term><parameter>rowcount</parameter></term>
         <listitem>
          <para>
           <literal>DB2_ROWCOUNT_PREFETCH_ON</literal> -
           клиент может запросить количество строк перед
           извлечением, что означает, что функция
           <function>db2_num_rows</function> возвратит
           количество выбранных строк, даже если 
           используется курсор
           <literal>ROLLFORWARD_ONLY</literal>.
          </para>
          <para>
           <literal>DB2_ROWCOUNT_PREFETCH_OFF</literal> -
           клиент не может запросить количество строк перед
           извлечением
          </para>
         </listitem>
        </varlistentry>
       </variablelist>
      </para>            
      <para>
       Следующие новые опции доступны в ibm_db2 версии 
       1.7.0 и выше.
       <variablelist>
        <varlistentry>
         <term><parameter>trusted_user</parameter></term>
         <listitem>
          <para>
           Для переведения пользователя в статус доверенного
           пользователя, укажите идентификатор (строка)
           доверенного пользователя в качестве значения этого
           параметра. Эта опция может быть задана только
           для ресурса соединения. Для использования этой 
           опции необходимо, чтобы для соединения был 
           разрешендоверенный контекст.
          </para>
         </listitem>
        </varlistentry>
        <varlistentry>
         <term><parameter>trusted_password</parameter></term>
         <listitem>
          <para>
           Пароль (строка), соответствующий идентификатору
           пользователя, заданному в trusted_user.
          </para>
         </listitem>
        </varlistentry>                
       </variablelist>
      </para>            
      <para>
       Следующие новые опции доступны в ibm_db2 версии 
       1.6.0 и выше. Эти опции предоставляют полезную
       информацию, которую можно получить через
       <function>db2_get_option</function>.
       <note>
        <para>
         Если значения каждой опции задано, некоторые
         серверы могут не суметь обработать все значение и
         обрежут его.
        </para>
        <para>
         Для уверенности в том, что все опции сконвертированы
         корректно при передаче на хост, используйте только 
         символы A-Z, 0-9, подчеркивание(_) и точку (.).
        </para>
       </note>
       <variablelist>
        <varlistentry>
         <term><parameter>userid</parameter></term>
         <listitem>
          <para>
           <literal>SQL_ATTR_INFO_USERID</literal> - указатель
           на символьную строку, кончающуюся null-байтом и
           содержащую идентификатор пользователя, переданный
           базе данный при соединении.
           <note>
            <para>
             DB2 для серверов z/OS и OS/390 поддерживает 
             длину вплоть до 16 символов. Идентификатор 
             пользователя никак не скомпрометирует 
             идентификатор авторизации - это разные сущности.
            </para>
           </note>
          </para>
         </listitem>
        </varlistentry>
        <varlistentry>
         <term><parameter>acctstr</parameter></term>
         <listitem>
          <para>
           <literal>SQL_ATTR_INFO_ACCTSTR</literal> - указатель
           на символьную строку, кончающуюся null-байтом и
           использующуюся для идентификации учетной строки
           клиента, соответствующей посланой на сервер при 
           соединении.
           <note>
            <para>
             DB2 для серверов z/OS и OS/390 поддерживает 
             длину вплоть до 200 символов.
            </para>
           </note>
          </para>
         </listitem>
        </varlistentry>
        <varlistentry>
         <term><parameter>applname</parameter></term>
         <listitem>
          <para>
           <literal>SQL_ATTR_INFO_APPLNAME</literal> - указатель
           на символьную строку, кончающуюся null-байтом и
           использующуюся для идентификации имени 
           клиентского приложения, соответствующей посланой 
           на сервер при соединении.
           <note>
            <para>
             DB2 для серверов z/OS и OS/390 поддерживает 
             длину вплоть до 32 символов.
            </para>
           </note>
          </para>
         </listitem>
        </varlistentry>
        <varlistentry>
         <term><parameter>wrkstnname</parameter></term>
         <listitem>
          <para>
           <literal>SQL_ATTR_INFO_WRKSTNNAME</literal> - указатель
           на символьную строку, кончающуюся null-байтом и
           использующуюся для идентификации имени 
           рабочей станции, соответствующей посланой 
           на сервер при соединении.
           <note>
            <para>
             DB2 для серверов z/OS и OS/390 поддерживает 
             длину вплоть до 18 символов.
            </para>
           </note>
          </para>
         </listitem>
        </varlistentry>
       </variablelist>
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><parameter>type</parameter></term>
     <listitem>
      <para>
       Целочисленное значение, определяющее тип ресурса, 
       который был передан в функцию.
      </para>
      <para>
       <literal>1</literal> - передан ресурс соединения.
      </para>
      <para>
       Любое другое значение, отличное от <literal>1</literal>
       означает ресурс оператора.
      </para>
     </listitem>
    </varlistentry>
   </variablelist>
  </para>
  <para>
  </para>
  <para>
   Следующая таблица показывает, какие параметры совместимы
   с какими ресурсами:
   <table>
    <title>Матрица ресурс/параметр</title>
    <tgroup cols="5">
     <colspec colnum="1" colname="col1" align="center" />
     <colspec colnum="2" colname="col2" align="center" />
     <colspec colnum="3" colname="col3" align="center" />
     <colspec colnum="4" colname="col4" align="center" />
     <colspec colnum="5" colname="col5" align="center" />
     
     <thead>
      <row>
       <entry morerows="1">Ключ</entry>
       <entry morerows="1">Значение</entry>
       <entry namest="col3" nameend="col5">Тип ресурса</entry>
      </row>
     </thead>
     
     <tbody>
      <row>
       <entry colname="col3">Соединение</entry>
       <entry colname="col4">Оператор</entry>
       <entry colname="col5">Результирующий набор</entry>
      </row>
      <row>
       <entry>autocommit</entry>
       <entry><literal>DB2_AUTOCOMMIT_ON</literal></entry>
       <entry colname="col3">X</entry>
       <entry colname="col4">-</entry>
       <entry colname="col5">-</entry>
      </row>
      <row>
       <entry>autocommit</entry>
       <entry><literal>DB2_AUTOCOMMIT_OFF</literal></entry>
       <entry colname="col3">X</entry>
       <entry colname="col4">-</entry>
       <entry colname="col5">-</entry>
      </row>
      <row>
       <entry>cursor</entry>
       <entry><literal>DB2_SCROLLABLE</literal></entry>
       <entry colname="col3">-</entry>
       <entry colname="col4">X</entry>
       <entry colname="col5">-</entry>
      </row>
      <row>
       <entry>cursor</entry>
       <entry><literal>DB2_FORWARD_ONLY</literal></entry>
       <entry colname="col3">-</entry>
       <entry colname="col4">X</entry>
       <entry colname="col5">-</entry>
      </row>
      <row>
       <entry>binmode</entry>
       <entry><literal>DB2_BINARY</literal></entry>
       <entry colname="col3">X</entry>
       <entry colname="col4">X</entry>
       <entry colname="col5">-</entry>
      </row>
      <row>
       <entry>binmode</entry>
       <entry><literal>DB2_CONVERT</literal></entry>
       <entry colname="col3">X</entry>
       <entry colname="col4">X</entry>
       <entry colname="col5">-</entry>
      </row>
      <row>
       <entry>binmode</entry>
       <entry><literal>DB2_PASSTHRU</literal></entry>
       <entry colname="col3">X</entry>
       <entry colname="col4">X</entry>
       <entry colname="col5">-</entry>
      </row>
      <row>
       <entry>db2_attr_case</entry>
       <entry><literal>DB2_CASE_LOWER</literal></entry>
       <entry colname="col3">X</entry>
       <entry colname="col4">X</entry>
       <entry colname="col5">-</entry>
      </row>
      <row>
       <entry>db2_attr_case</entry>
       <entry><literal>DB2_CASE_UPPER</literal></entry>
       <entry colname="col3">X</entry>
       <entry colname="col4">X</entry>
       <entry colname="col5">-</entry>
      </row>
      <row>
       <entry>db2_attr_case</entry>
       <entry><literal>DB2_CASE_NATURAL</literal></entry>
       <entry colname="col3">X</entry>
       <entry colname="col4">X</entry>
       <entry colname="col5">-</entry>
      </row>
      <row>
       <entry>deferred_prepare</entry>
       <entry><literal>DB2_DEFERRED_PREPARE_ON</literal></entry>
       <entry colname="col3">-</entry>
       <entry colname="col4">X</entry>
       <entry colname="col5">-</entry>
      </row>
      <row>
       <entry>deferred_prepare</entry>
       <entry><literal>DB2_DEFERRED_PREPARE_OFF</literal></entry>
       <entry colname="col3">-</entry>
       <entry colname="col4">X</entry>
       <entry colname="col5">-</entry>
      </row>
      <row>
       <entry>i5_fetch_only</entry>
       <entry><literal>DB2_I5_FETCH_ON</literal></entry>
       <entry colname="col3">-</entry>
       <entry colname="col4">X</entry>
       <entry colname="col5">-</entry>
      </row>
      <row>
       <entry>i5_fetch_only</entry>
       <entry><literal>DB2_I5_FETCH_OFF</literal></entry>
       <entry colname="col3">-</entry>
       <entry colname="col4">X</entry>
       <entry colname="col5">-</entry>
      </row>
      <row>
       <entry>rowcount</entry>
       <entry><literal>DB2_ROWCOUNT_PREFETCH_ON</literal></entry>
       <entry colname="col3">-</entry>
       <entry colname="col4">X</entry>
       <entry colname="col5">-</entry>
      </row>
      <row>
       <entry>rowcount</entry>
       <entry><literal>DB2_ROWCOUNT_PREFETCH_OFF</literal></entry>
       <entry colname="col3">-</entry>
       <entry colname="col4">X</entry>
       <entry colname="col5">-</entry>
      </row>
      <row>
       <entry>trusted_user</entry>
       <entry><literal>&lt;USER NAME&gt; (String)</literal></entry>
       <entry colname="col3">X</entry>
       <entry colname="col4">-</entry>
       <entry colname="col5">-</entry>
      </row>
      <row>
       <entry>trusted_password</entry>
       <entry><literal>&lt;PASSWORD&gt; (String)</literal></entry>
       <entry colname="col3">X</entry>
       <entry colname="col4">-</entry>
       <entry colname="col5">-</entry>
      </row>
      <row>
       <entry>userid</entry>
       <entry><literal>SQL_ATTR_INFO_USERID</literal></entry>
       <entry colname="col3">X</entry>
       <entry colname="col4">X</entry>
       <entry colname="col5">-</entry>
      </row>
      <row>
       <entry>acctstr</entry>
       <entry><literal>SQL_ATTR_INFO_ACCTSTR</literal></entry>
       <entry colname="col3">X</entry>
       <entry colname="col4">X</entry>
       <entry colname="col5">-</entry>
      </row>
      <row>
       <entry>applname</entry>
       <entry><literal>SQL_ATTR_INFO_APPLNAME</literal></entry>
       <entry colname="col3">X</entry>
       <entry colname="col4">X</entry>
       <entry colname="col5">-</entry>
      </row>
      <row>
       <entry>wrkstnname</entry>
       <entry><literal>SQL_ATTR_INFO_WRKSTNNAME</literal></entry>
       <entry colname="col3">X</entry>
       <entry colname="col4">X</entry>
       <entry colname="col5">-</entry>
      </row>
     </tbody>
    </tgroup>
   </table>
  </para>
 </refsect1>
 
 <refsect1 role="returnvalues">
  &reftitle.returnvalues;
  <para>
   &return.success;
  </para>
 </refsect1>
 <!-- Place Changelog next if any -->
 
 <!-- Place Examples next if any -->
 <refsect1 role="examples">
  &reftitle.examples;
  <para>
   
   <example>
    <title>Установка одного параметра для ресурса соединения</title>
    <programlisting role="php">
<![CDATA[
<?php
/* Параметры соединения с базой данных */
$database = 'SAMPLE';
$hostname = 'localhost';
$port = 50000;
$protocol = 'TCPIP';
$username = 'db2inst1';
$password = 'ibmdb2';

/* Строка соединения */
$conn_string = "DRIVER={IBM DB2 ODBC DRIVER};DATABASE=$database;";
$conn_string .= "HOSTNAME=$hostname;PORT=$port;PROTOCOL=$protocol;";
$conn_string .= "UID=$username;PWD=$password;";

/* Получаем ресурс соединения */
$conn = db2_connect($conn_string, '', '');

/* Создаем ассоциативный массив опций */
$options = array('autocommit' => DB2_AUTOCOMMIT_ON);

/* Вызываем функцию */
$result = db2_set_option($conn, $options, 1);

/* Проверяем, все ли опции установились */
if($result)
{
  echo 'Options Set Successfully';
}
else
{
  echo 'Could Not Set Options';
}
?>
]]>
       </programlisting>
       &example.outputs;
<screen><![CDATA[Options Set Successfully]]></screen>
     </example>
     
     <example>
      <title>Установка нескольких параметров для ресурса соединения</title>
      <programlisting role="php">
<![CDATA[
<?php
/* Параметры соединения с базой данных */
$database = 'SAMPLE';
$hostname = 'localhost';
$port = 50000;
$protocol = 'TCPIP';
$username = 'db2inst1';
$password = 'ibmdb2';

/* Строка соединения */
$conn_string = "DRIVER={IBM DB2 ODBC DRIVER};DATABASE=$database;";
$conn_string .= "HOSTNAME=$hostname;PORT=$port;PROTOCOL=$protocol;";
$conn_string .= "UID=$username;PWD=$password;";

/* Получаем ресурс соединения */
$conn = db2_connect($conn_string, '', '');

/* Создаем ассоциативный массив опций */
$options = array('autocommit' => DB2_AUTOCOMMIT_OFF, 
                    'binmode' => DB2_PASSTHRU,
              'db2_attr_case' => DB2_CASE_UPPER,
                     'cursor' => DB2_SCROLLABLE);

/* Вызываем функцию */
$result = db2_set_option($conn, $options, 1);

/* Проверяем, все ли опции установились */
if($result)
{
  echo 'Options Set Successfully';
}
else
{
  echo 'Could Not Set Options';
}
?>
]]>
       </programlisting>
       &example.outputs;
<screen><![CDATA[Options Set Successfully]]></screen>
     </example>
     
     <!-- Behaves Incorrectly -->
     <example>
      <title>Установка нескольких параметров с одним некорректным ключем</title>
      <programlisting role="php">
<![CDATA[
<?php
/* Параметры соединения с базой данных */
$database = 'SAMPLE';
$hostname = 'localhost';
$port = 50000;
$protocol = 'TCPIP';
$username = 'db2inst1';
$password = 'ibmdb2';

/* Строка соединения */
$conn_string = "DRIVER={IBM DB2 ODBC DRIVER};DATABASE=$database;";
$conn_string .= "HOSTNAME=$hostname;PORT=$port;PROTOCOL=$protocol;";
$conn_string .= "UID=$username;PWD=$password;";

/* Получаем ресурс соединения */
$conn = db2_connect($conn_string, '', '');

/* Создаем ассоциативный массив опций */
$options = array('autocommit' => DB2_AUTOCOMMIT_OFF, 
             'MY_INVALID_KEY' => DB2_PASSTHRU,
              'db2_attr_case' => DB2_CASE_UPPER,
                     'cursor' => DB2_SCROLLABLE);

/* Вызываем функцию */
$result = db2_set_option($conn, $options, 1);

/* Проверяем, все ли опции установились */
if($result)
{
  echo 'Options Set Successfully';
}
else
{
  echo 'Could Not Set Options';
}
?>
]]>
       </programlisting>
       &example.outputs;
<screen><![CDATA[Could Not Set Options]]></screen>
     </example>
     
     <!-- Behaves Incorrectly -->
     <example>
      <title>Установка нескольких параметров с одним некорректным значением</title>
      <programlisting role="php">
<![CDATA[
<?php
/* Параметры соединения с базой данных */
$database = 'SAMPLE';
$hostname = 'localhost';
$port = 50000;
$protocol = 'TCPIP';
$username = 'db2inst1';
$password = 'ibmdb2';

/* Строка соединения */
$conn_string = "DRIVER={IBM DB2 ODBC DRIVER};DATABASE=$database;";
$conn_string .= "HOSTNAME=$hostname;PORT=$port;PROTOCOL=$protocol;";
$conn_string .= "UID=$username;PWD=$password;";

/* Получаем ресурс соединения */
$conn = db2_connect($conn_string, '', '');

/* Создаем ассоциативный массив опций */
$options = array('autocommit' => DB2_AUTOCOMMIT_OFF, 
                    'binmode' => 'INVALID_VALUE',
              'db2_attr_case' => DB2_CASE_UPPER,
                     'cursor' => DB2_SCROLLABLE);

/* Вызываем функцию */
$result = db2_set_option($conn, $options, 1);

/* Проверяем, все ли опции установились */
if($result)
{
  echo 'Options Set Successfully';
}
else
{
  echo 'Could Not Set Options';
}
?>
]]>
       </programlisting>
       &example.outputs;
<screen><![CDATA[Could Not Set Options]]></screen>
     </example>
     
     <example>
      <title>Setting multiple parameters with a connection resource and the wrong type</title>
      <programlisting role="php">
<![CDATA[
<?php
/* Параметры соединения с базой данных */
$database = 'SAMPLE';
$hostname = 'localhost';
$port = 50000;
$protocol = 'TCPIP';
$username = 'db2inst1';
$password = 'ibmdb2';

/* Строка соединения */
$conn_string = "DRIVER={IBM DB2 ODBC DRIVER};DATABASE=$database;";
$conn_string .= "HOSTNAME=$hostname;PORT=$port;PROTOCOL=$protocol;";
$conn_string .= "UID=$username;PWD=$password;";

/* Получаем ресурс соединения */
$conn = db2_connect($conn_string, '', '');

/* Создаем ассоциативный массив опций */
$options = array('autocommit' => DB2_AUTOCOMMIT_OFF, 
                    'binmode' => DB2_PASSTHRU,
              'db2_attr_case' => DB2_CASE_UPPER,
                     'cursor' => DB2_SCROLLABLE);

/* Вызываем функцию */
$result = db2_set_option($conn, $options, 2);

/* Проверяем, все ли опции установились */
if($result)
{
  echo 'Options Set Successfully';
}
else
{
  echo 'Could Not Set Options';
}
?>
]]>
       </programlisting>
       &example.outputs;
<screen><![CDATA[Could Not Set Options]]></screen>
     </example>
     
     <example>
      <title>Setting multiple parameters with the wrong resource</title>
      <programlisting role="php">
<![CDATA[
<?php
/* Параметры соединения с базой данных */
$database = 'SAMPLE';
$hostname = 'localhost';
$port = 50000;
$protocol = 'TCPIP';
$username = 'db2inst1';
$password = 'ibmdb2';

/* Строка соединения */
$conn_string = "DRIVER={IBM DB2 ODBC DRIVER};DATABASE=$database;";
$conn_string .= "HOSTNAME=$hostname;PORT=$port;PROTOCOL=$protocol;";
$conn_string .= "UID=$username;PWD=$password;";

/* Получаем ресурс соединения */
$conn = db2_connect($conn_string, '', '');

/* Создаем ассоциативный массив опций */
$options = array('autocommit' => DB2_AUTOCOMMIT_OFF, 
                    'binmode' => DB2_PASSTHRU,
              'db2_attr_case' => DB2_CASE_UPPER,
                     'cursor' => DB2_SCROLLABLE);

$stmt = db2_prepare($conn, 'SELECT * FROM EMPLOYEE');

/* Вызываем функцию */
$result = db2_set_option($stmt, $options, 1);

/* Проверяем, все ли опции установились */
if($result)
{
  echo 'Options Set Successfully';
}
else
{
  echo 'Could Not Set Options';
}
?>
]]>
       </programlisting>
       &example.outputs;
<screen><![CDATA[Could Not Set Options]]></screen>
     </example>
     
     <example>
      <title>Putting it all together</title>
      <programlisting role="php">
<![CDATA[
<?php
/* Параметры соединения с базой данных */
$database = 'SAMPLE';
$hostname = 'localhost';
$port = 50000;
$protocol = 'TCPIP';
$username = 'db2inst1';
$password = 'ibmdb2';

/* Строка соединения */
$conn_string = "DRIVER={IBM DB2 ODBC DRIVER};DATABASE=$database;";
$conn_string .= "HOSTNAME=$hostname;PORT=$port;PROTOCOL=$protocol;";
$conn_string .= "UID=$username;PWD=$password;";

/* Получаем ресурс соединения */
$conn = db2_connect($conn_string, '', '');

/* Создаем ассоциативный массив опций */
$options = array('db2_attr_case' => DB2_CASE_LOWER,
                        'cursor' => DB2_SCROLLABLE);

$stmt = db2_prepare($conn, 'SELECT * FROM EMPLOYEE WHERE EMPNO = ? OR EMPNO = ?');

/* Вызываем функцию */
$option_result = db2_set_option($stmt, $options, 2);
$result = db2_execute($stmt, array('000130', '000140'));

/* Получаем строку 2 перед строкой 1. Перематываемый курсор! */
print_r(db2_fetch_assoc($stmt, 2));
print '<br /><br />';
print_r(db2_fetch_assoc($stmt, 1));

?>
]]>
       </programlisting>
       &example.outputs;
<screen><![CDATA[Array
(
    [empno] => 000140
    [firstnme] => HEATHER
    [midinit] => A
    [lastname] => NICHOLLS
    [workdept] => C01
    [phoneno] => 1793
    [hiredate] => 1976-12-15
    [job] => ANALYST
    [edlevel] => 18
    [sex] => F
    [birthdate] => 1946-01-19
    [salary] => 28420.00
    [bonus] => 600.00
    [comm] => 2274.00
)

Array
(
    [empno] => 000130
    [firstnme] => DELORES
    [midinit] => M
    [lastname] => QUINTANA
    [workdept] => C01
    [phoneno] => 4578
    [hiredate] => 1971-07-28
    [job] => ANALYST
    [edlevel] => 16
    [sex] => F
    [birthdate] => 1925-09-15
    [salary] => 23800.00
    [bonus] => 500.00
    [comm] => 1904.00
)]]></screen>
     </example>
     <example>
      <title>Курсор i5/OS только для чтения</title>
      <programlisting role="php">
<![CDATA[
<?php
  $conn = db2_connect("", "", "", array("i5_lib"=>"nobody"));
  $stmt = db2_prepare($conn, 'select * from names where first = ?');
  $name = "first2";
  db2_bind_param($stmt, 1, "name", DB2_PARAM_IN);
  $options = array("i5_fetch_only"=>DB2_I5_FETCH_ON);
  db2_set_option($stmt,$options,0);
  if (db2_execute($stmt)) {
    while ($row = db2_fetch_array($stmt)) {
      echo "{$row[0]} {$row[1]}";
    }
  }
?>
]]>
       </programlisting>
       &example.outputs;
       <screen>
<![CDATA[
first2 last2
]]>
       </screen>
     </example>
   </para>
 </refsect1>
 <refsect1 role="seealso">
  &reftitle.seealso;
  <para>
   <simplelist>
    <member><function>db2_connect</function></member>
    <member><function>db2_pconnect</function></member>
    <member><function>db2_exec</function></member>
    <member><function>db2_prepare</function></member>
    <member><function>db2_cursor_type</function></member>
   </simplelist>
  </para>
 </refsect1>
</refentry>

<!-- Keep this comment at the end of the file
Local variables:
mode: sgml
sgml-omittag:t
sgml-shorttag:t
sgml-minimize-attributes:nil
sgml-always-quote-attributes:t
sgml-indent-step:1
sgml-indent-data:t
indent-tabs-mode:nil
sgml-parent-document:nil
sgml-default-dtd-file:"~/.phpdoc/manual.ced"
sgml-exposed-tags:nil
sgml-local-catalogs:nil
sgml-local-ecat-files:nil
End:
vim600: syn=xml fen fdm=syntax fdl=2 si
vim: et tw=78 syn=sgml
vi: ts=1 sw=1
-->
