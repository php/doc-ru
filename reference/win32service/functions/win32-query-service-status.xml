<?xml version="1.0" encoding="utf-8"?>
<!-- EN-Revision: 0d5b0198bfeee039849d521866503120351476d3 Maintainer: sergey Status: ready -->
<!-- Reviewed: no -->

<!-- Generated by xml_proto.php v2.3. Found in /scripts directory of phpdoc. -->
<refentry xml:id="function.win32-query-service-status" xmlns="http://docbook.org/ns/docbook">
 <refnamediv>
  <refname>win32_query_service_status</refname>
  <refpurpose>Запрашивает статус сервиса</refpurpose>
 </refnamediv>
 <refsect1 role="description">
  &reftitle.description;
  <methodsynopsis>
   <type>array</type><methodname>win32_query_service_status</methodname>
   <methodparam><type>string</type><parameter>servicename</parameter></methodparam>
   <methodparam choice="opt"><type>string</type><parameter>machine</parameter></methodparam>
  </methodsynopsis>

  <para>
   Запрашивает текущий статус службы, возвращая массив информации.
  </para>

 </refsect1>
 <refsect1 role="parameters">
  &reftitle.parameters;
  <para>
   <variablelist>
    <varlistentry>
     <term><parameter>servicename</parameter></term>
     <listitem>
      <para>
       Краткое название службы.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><parameter>machine</parameter></term>
     <listitem>
      <para>
       Необязательное имя машины. Если не указано, будет использоваться локальный компьютер.
      </para>
     </listitem>
    </varlistentry>
   </variablelist>
  </para>
 </refsect1>

 <refsect1 role="returnvalues">
  &reftitle.returnvalues;
  <para>
   Возвращает массив, состоящий из следующей информации в случае успешного выполнения:
  </para>
  <para>
    До версии 1.0.0 &win32service.false.error;
  </para>
  <para>
   <variablelist>
    <varlistentry>
     <term><parameter>ServiceType</parameter></term>
     <listitem>
      <para>
       dwServiceType. Смотрите <link linkend="win32service.constants.servicetype">Битовые маски типов службы Win32Service</link>.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><parameter>CurrentState</parameter></term>
     <listitem>
      <para>
       dwCurrentState. Смотрите <link linkend="win32service.constants.servicestatus">Константы состояния службы Win32Service</link>.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><parameter>ControlsAccepted</parameter></term>
     <listitem>
      <para>
       Какие элементы управления службами принимаются службой. Смотрите <link linkend="win32service.constants.controlsaccepted">Битовые маски Win32Service Service Control Message Accepted</link>.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><parameter>Win32ExitCode</parameter></term>
     <listitem>
      <para>
       Если служба завершила работу, здесь отображается код возврата из процесса.
       Это значение равно <constant>WIN32_ERROR_SERVICE_SPECIFIC_ERROR</constant>,
       если режим выхода не является плавным. Смотрите
       <link linkend="win32service.constants.errors">коды ошибок Win32Service</link> и
       <function>win32_set_service_exit_mode</function>
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><parameter>ServiceSpecificExitCode</parameter></term>
     <listitem>
      <para>
       Если служба завершила работу, здесь отображается код конкретной службы,
       зарегистрированный в журнале событий. Это значение равно значению,
       определённому <function>win32_set_service_exit_code</function>
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><parameter>CheckPoint</parameter></term>
     <listitem>
      <para>
       Если служба завершила работу, здесь отображается текущий номер контрольной точки.
       Это используется SCM как своего рода сердцебиение для обнаружения заклинившего процесса обслуживания.
       Значение контрольной точки лучше всего интерпретировать вместе со значением WaitHint.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><parameter>WaitHint</parameter></term>
     <listitem>
      <para>
       Если служба завершила работу, она установит для WaitHint значение контрольной точки,
       которое будет указывать на 100% завершение. Это можно использовать для
       реализации индикатора прогресса.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><parameter>ProcessId</parameter></term>
     <listitem>
      <para>
       Идентификатор процесса Windows. Если 0, процесс не запущен.
      </para>
     </listitem>
    </varlistentry>
    <varlistentry>
     <term><parameter>ServiceFlags</parameter></term>
     <listitem>
      <para>
       dwServiceFlags. Смотрите <link linkend="win32service.constants.serviceflag">Константы флагов службы Win32Service</link>.
      </para>
     </listitem>
    </varlistentry>
   </variablelist>
  </para>

 </refsect1>


 <refsect1 role="errors"><!-- {{{ -->
  &reftitle.errors;
  <para>
    Выбрасывается <classname>ValueError</classname>, если
    значение параметра <parameter>servicename</parameter> не указано.
  </para>
 </refsect1><!-- }}} -->

 <refsect1 role="changelog"><!-- {{{ -->
  &reftitle.changelog;
  <para>
   <informaltable>
    <tgroup cols="2">
     <thead>
      <row>
       <entry>&Version;</entry>
       <entry>&Description;</entry>
      </row>
     </thead>
     <tbody>
      <row>
       <entry>PECL win32service 1.0.0</entry>
       <entry>
        Выбрасывает <classname>ValueError</classname> в случае неверных данных в параметрах,
        ранее возвращалось &false;.
       </entry>
      </row>
      <row>
       <entry>PECL win32service 1.0.0</entry>
       <entry>
        Выбрасывает <classname>Win32ServiceException</classname> в случае возникновения ошибки,
        ранее возвращался
        <link xmlns="http://docbook.org/ns/docbook" linkend="win32service.constants.errors">Код ошибки Win32</link>.
       </entry>
      </row>
      <row>
       <entry>PECL win32service 1.0.0</entry>
       <entry>
        Тип возврата теперь <type>array</type>, ранее был <type>mixed</type>.
       </entry>
      </row>
     </tbody>
    </tgroup>
   </informaltable>
  </para>
 </refsect1><!-- }}} -->

 <refsect1 role="seealso">
  &reftitle.seealso;
  <para>
   <simplelist>
    <member><link linkend="win32service.constants">Предопределённые константы Win32Service</link></member>
   </simplelist>
  </para>
 </refsect1>

</refentry>
<!-- Keep this comment at the end of the file
Local variables:
mode: sgml
sgml-omittag:t
sgml-shorttag:t
sgml-minimize-attributes:nil
sgml-always-quote-attributes:t
sgml-indent-step:1
sgml-indent-data:t
indent-tabs-mode:nil
sgml-parent-document:nil
sgml-default-dtd-file:"~/.phpdoc/manual.ced"
sgml-exposed-tags:nil
sgml-local-catalogs:nil
sgml-local-ecat-files:nil
End:
vim600: syn=xml fen fdm=syntax fdl=2 si
vim: et tw=78 syn=sgml
vi: ts=1 sw=1
-->
