<?xml version="1.0" encoding="utf-8"?>
<!-- EN-Revision: 8ad0d94e1c87b2daabff88e74acc31e8a11eec0a Maintainer: mch Status: ready -->
<!-- Based on UPGRADING version 322438. Work in progess !-->
<!-- $Revision$ -->
<!-- Reviewed: no -->
<appendix xml:id="migration54" xmlns="http://docbook.org/ns/docbook" xmlns:xlink="http://www.w3.org/1999/xlink">
 <title>Переход с PHP 5.3.x на PHP 5.4.x</title>
 <simpara>
  &manual.migration.seealso;
  <link linkend="migration5">5.0.x</link>,
  <link linkend="migration51">5.1.x</link>,
  <link linkend="migration52">5.2.x</link>,
  <link linkend="migration53">5.3.x</link> и
  <link linkend="migration55">5.5.x</link>.
 </simpara>

 <section xml:id="migration54.changes">
  <title>Что изменилось в PHP 5.4.x?</title>
  <simpara>
   Большинство изменений в PHP 5.4.x никак не повлияет на существующий код.
   Есть <link linkend="migration54.incompatible">несколько несовместимостей</link>
   и <link linkend="migration54.new-features">новых возможностей</link>, которые
   должны быть учтены, и код должен быть протестирован перед тем как переключиться
   на новую версию PHP на рабочих серверах.
  </simpara>
  <simpara>
   Для систем, которые обновились с более старой версии PHP, соответствующую
   документацию можно получить по адресам:
  </simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <link linkend="migration53">Переход с PHP 5.2.x на PHP 5.3.x</link>.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <link linkend="migration52">Переход с PHP 5.1.x на PHP 5.2.x</link>.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <link linkend="migration51">Переход с PHP 5.0.x на PHP 5.1.x</link>.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <link linkend="migration5">Переход с PHP 4 на PHP 5.0.x</link>.
    </simpara>
   </listitem>
  </itemizedlist>
 </section>

 <section xml:id="migration54.incompatible">
  <title>Обратно несовместимые изменения</title>
  <simpara>
   Хотя большая часть существующего кода PHP 5 должна работать без изменений,
   пожалуйста, примите к сведению следующие обратно несовместимые изменения:
  </simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <link linkend="features.safe-mode">Безопасный режим</link> более
     не поддерживается. Любое приложение, которое полагается на безопасный режим, возможно,
     требует внесения корректировок по части безопасности.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <link linkend="security.magicquotes">"Волшебные" кавычки</link> теперь не работают. Приложения, которые используют
     эту возможность, могут нуждаться в обновлении во избежание проблем с безопасностью.
    </simpara>
    <simpara>
     Функции <function>get_magic_quotes_gpc</function> и <function>get_magic_quotes_runtime</function>
     теперь всегда возвращают &false;. Функция <function>set_magic_quotes_runtime</function> вызывает ошибку уровня
     <constant>E_CORE_ERROR</constant>.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     Директивы &php.ini; <link linkend="ini.register-globals">register_globals</link> и
     <link linkend="ini.register-long-arrays">register_long_arrays</link>
     были удалены.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     Возможность <link linkend="language.references.pass">передачи по ссылке во время вызова функции</link> была убрана.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     Операторы <link linkend="control-structures.break">break</link>
     и <link linkend="control-structures.continue">continue</link>
     теперь не принимают аргументов в виде переменной. Например, выражение
     <literal>break 1 + foo() * $bar;</literal> невозможно.
     Вы по-прежнему можете использовать явный аргумент в
     виде статической константы. Например, <literal>break 2;</literal>. Побочным эффектом этого изменения является то, что
     конструкции <literal>break 0;</literal> и <literal>continue 0;</literal> более недопустимы.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     В расширении <link linkend="book.datetime">date and time</link> временная зона не может быть более
     установлена с помощью переменной окружения TZ. Вместо этого вам необходимо указать временную зону, используя
     опцию &php.ini; <link linkend="ini.date.timezone">date.timezone</link> или функцию <function>date_default_timezone_set</function>.
     PHP теперь не будет пытаться определять временную зону. Вместо этого будет установлена зона "UTC" и
     выдано предупреждение <constant>E_WARNING</constant>.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     Нецифровые смещения строк, например <literal>$a['foo']</literal>, где $a - это строка, теперь возвращают
     false в функции <function>isset</function> и true в функции <function>empty</function> и вызывают предупреждение <constant>E_WARNING</constant>
     при подобном использовании. Смещения, заданные типами double, bool и null также приводят к генерации предупреждения <constant>E_NOTICE</constant>,
     а строки, содержащие числа (<literal>$a['2']</literal>), все еще работают как и раньше. Обратите внимание, что смещения, подобные <literal>'12.3'</literal> и
     <literal>'5 foobar'</literal> рассматриваются как нечисловые и вызывают предупреждение <constant>E_WARNING</constant>, но преобразовываются
     к 12 и 5 соответственно по причине необходимости сохранения обратной совместимости.
    </simpara>
    <simpara>
     Примечание: следующий код возвращает различные результаты.
    </simpara>
    <simpara>
     $str='abc';var_dump(isset($str['x'])); // false для PHP 5.4 и выше, но true для 5.3 и ниже
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     Преобразование массива в строку теперь приводит к предупреждению <constant>E_NOTICE</constant>, но результат
     преобразования будет по-прежнему строка <literal>"Array"</literal>.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     Преобразование &null;, &false; или пустой строки в объект путем добавления свойства
     теперь будет генерировать ошибку уровня <constant>E_WARNING</constant> вместо ошибки <constant>E_STRICT</constant>.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     Имена параметров, которые "затеняют" имена суперглобальных переменных, теперь расцениваются как фатальная ошибка.
     Это правило запрещает код, подобный этому: <literal>function foo($_GET, $_POST) {}</literal>.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <link linkend="book.hash">Хеш-алгоритмы</link> Salsa10 и Salsa20 были удалены.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     Функция <function>array_combine</function> теперь возвращает <literal>array()</literal> вместо &false;,
     когда в качестве параметров заданы два пустых массива.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     Если вы используете функцию <function>htmlentities</function> с азиатскими наборами символов,
     то она работает также, как функция <function>htmlspecialchars</function>. Так всегда было
     в предыдущих версиях PHP, а теперь генерируется ошибка
     уровня <constant>E_STRICT</constant>.
    </simpara>
   </listitem>
  </itemizedlist>
  <simpara>
   Следующие ключевые слова теперь являются <link linkend="reserved">зарезервированными</link> и не могут
   использоваться в качестве названия функций, классов и прочих имен:
  </simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <link linkend="language.oop5.traits">trait</link>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <link linkend="language.types.callable">callable</link>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <link linkend="language.oop5.traits">insteadof</link>
    </simpara>
   </listitem>
  </itemizedlist>
  <simpara>
   Следующие функции были удалены из PHP:
  </simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <function>define_syslog_variables</function>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>import_request_variables</function>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>session_is_registered</function>, <function>session_register</function>
     и <function>session_unregister</function>.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     Алиасы
     <function>mysqli_bind_param</function>, <function>mysqli_bind_result</function>,
     <function>mysqli_client_encoding</function>, <function>mysqli_fetch</function>,
     <function>mysqli_param_count</function>, <function>mysqli_get_metadata</function>,
     <function>mysqli_send_long_data</function>, mysqli::client_encoding() и mysqli_stmt::stmt().
    </simpara>
   </listitem>
  </itemizedlist>
 </section>

 <section xml:id="migration54.new-features">
  <title>Новые возможности</title>
  <simpara>
   PHP версии 5.4.0 предлагает широкий спектр новых возможностей:
  </simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     Добавлена поддержка <link linkend="language.oop5.traits">трейтов</link>.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     Добавлен короткий синтаксис объявления массивов. Например, <literal>$a = [1, 2, 3, 4];</literal> или
     <literal>$a = ['one' => 1, 'two' => 2, 'three' => 3, 'four' => 4];</literal>.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     Добавлена возможность разыменования массивов, возвращаемых функциями. Например: <literal>foo()[0]</literal>.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <link linkend="functions.anonymous">Классы для создания анонимных функций (Closures)</link> теперь поддерживают <literal>$this</literal>.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     Оператор <literal>&lt;?=</literal> теперь доступен всегда, несмотря на значение &php.ini; опции
     <link linkend="ini.short-open-tag">short_open_tag</link>.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     Добавлена возможность получения доступа к члену класса при создании экземпляра.
     Например: <literal>(new Foo)-&gt;bar()</literal>.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     Теперь поддерживается такой синтаксис: <literal>Class::{expr}()</literal>.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     Добавлен бинарный формат задания чисел, например: <literal>0b001001101</literal>.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     Улучшены сообщения об ошибках разбора и предупреждения о несовместимых аргументах.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     Расширение по работе с сессиями теперь может отслеживать <link linkend="session.upload-progress">процесс загрузки</link> файлов.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     Встроенный <link linkend="features.commandline.webserver">веб-сервер в режиме командной строки</link> для разработчиков.
    </simpara>
   </listitem>
  </itemizedlist>
 </section>

 <section xml:id="migration54.sapi">
  <title>Изменения в модулях SAPI</title>
  <itemizedlist>
   <listitem>
    <simpara>
     Доступен новый модуль SAPI, называемый <literal>cli-server</literal>.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     Добавлена CLI-опция <literal>--rz</literal>, которая отображает информацию о имени расширения Zend.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     Добавлена ссылка <literal>#inisetting=value</literal> для изменения &php.ini; опций в процессе работы скрипта при интерактивной работе в консоли.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     Добавлены функции, совместимые с Apache: <function>apache_child_terminate</function>,
     <function>getallheaders</function>, <function>apache_request_headers</function>
     и <function>apache_response_headers</function> для FastCGI SAPI.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     PHP-FPM: Добавлена опция <literal>process.max</literal> для контроля количества ветвлений FPM-процессов.
    </simpara>
   </listitem>
  </itemizedlist>
 </section>

 <section xml:id="migration54.deprecated">
  <title>Устаревшие функции и возможности в PHP 5.4.x</title>
  <simpara>
   Устаревшие функции:
  </simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <function>mcrypt_generic_end</function>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>mysql_list_dbs</function>
    </simpara>
   </listitem>
  </itemizedlist>
 </section>

 <section xml:id="migration54.parameters">
  <title>Измененные функции</title>
  <simpara>
   К некоторым функциям были добавлены новые необязательные параметры в PHP 5.4:
  </simpara>
  <simpara>Ядро PHP:</simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     Добавлен необязательный аргумент <parameter>limit</parameter> к функциям <function>debug_backtrace</function> и
     <function>debug_print_backtrace</function> для ограничения количества возвращаемых фреймов стека.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     Функция <function>is_link</function> теперь работает правильно с символическими ссылками в системе Windows Vista
     или более поздними. Более ранние версии не поддерживали символические ссылки.
    </simpara>
   </listitem>
  </itemizedlist>
  <simpara>OpenSSL:</simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     В функции <function>openssl_encrypt</function> и <function>openssl_decrypt</function>
     добавлена опция "no padding" (не дополнять размер шифруемого блока).
    </simpara>
   </listitem>
  </itemizedlist>
  <simpara>Intl:</simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     Функции <function>idn_to_ascii</function> и <function>idn_to_utf8</function> теперь принимают два дополнительных
     параметра: один указывает вид (IDNA 2003 или UTS #46) и другой, передаваемый по ссылке,
     предназначен для возврата детальной информации об операции в случае выбора UTS #46.
    </simpara>
   </listitem>
  </itemizedlist>
 </section>

 <section xml:id="migration54.functions">
  <title>Новые функции</title>
  <simpara>
   В PHP 5.4 введены несколько новых функций:
  </simpara>
  <simpara>Ядро PHP:</simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <function>hex2bin</function> - Преобразует шестнадцатеричное представление данных в двоичное
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>http_response_code</function> - Получить или установить код ответа HTTP
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>get_declared_traits</function> - Получить список задекларированных трейтов
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>getimagesizefromstring</function> - Получение размера изображения из строки данных
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>stream_set_chunk_size</function> <!-- DOC-RU TODO: Добавить тут описание функции -->
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>socket_import_stream</function> <!-- DOC-RU TODO: Добавить тут описание функции -->
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>trait_exists</function> <!-- DOC-RU TODO: Добавить тут описание функции -->
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>header_register_callback</function> - Вызывает функцию заголовка (header)
    </simpara>
   </listitem>
  </itemizedlist>
  <simpara><link linkend="book.spl">SPL:</link></simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <function>class_uses</function>
    </simpara>
   </listitem>
   </itemizedlist>
   <simpara><link linkend="book.session">Сессии:</link></simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <function>session_status</function>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>session_register_shutdown</function>
    </simpara>
   </listitem>
   </itemizedlist>
   <simpara><link linkend="book.mysqli">Mysqli:</link></simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <function>mysqli_error_list</function>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>mysqli_stmt_error_list</function>
    </simpara>
   </listitem>
   </itemizedlist>
   <simpara><link linkend="book.libxml">Libxml:</link></simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <function>libxml_set_external_entity_loader</function>
    </simpara>
   </listitem>
   </itemizedlist>
   <simpara><link linkend="book.ldap">LDAP:</link></simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <function>ldap_control_paged_result</function>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>ldap_control_paged_result_response</function>
    </simpara>
   </listitem>
   </itemizedlist>
   <simpara><link linkend="book.intl">Intl:</link></simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <function>transliterator_create</function>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>transliterator_create_from_rules</function>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>transliterator_create_inverse</function>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>transliterator_get_error_code</function>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>transliterator_get_error_message</function>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>transliterator_list_ids</function>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>transliterator_transliterate</function>
    </simpara>
   </listitem>
  </itemizedlist>
   <simpara><link linkend="book.zlib">Zlib:</link></simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <function>zlib_decode</function>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <function>zlib_encode</function>
    </simpara>
   </listitem>
  </itemizedlist>
 </section>

 <section xml:id="migration54.classes">
  <title>Новые классы и интерфейсы</title>
  <simpara>
   Следующие классы были введены в PHP 5.4.0:
  </simpara>
  <simpara><link linkend="book.spl">SPL</link>:</simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <classname>CallbackFilterIterator</classname>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <classname>RecursiveCallbackFilterIterator</classname>
    </simpara>
   </listitem>
  </itemizedlist>
  <simpara><link linkend="book.reflection">Reflection</link>:</simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <classname>ReflectionZendExtension</classname>
    </simpara>
   </listitem>
  </itemizedlist>
  <simpara><link linkend="book.json">Json</link>:</simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <classname>JsonSerializable</classname>
    </simpara>
   </listitem>
  </itemizedlist>
  <simpara><link linkend="book.session">Session</link>:</simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <classname>SessionHandler</classname>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <classname>SessionHandlerInterface</classname>
    </simpara>
   </listitem>
  </itemizedlist>
  <simpara><link linkend="book.snmp">Snmp</link>:</simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <classname>SNMP</classname>
    </simpara>
   </listitem>
  </itemizedlist>
  <simpara><link linkend="book.intl">Intl</link>:</simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <classname>Transliterator</classname>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <classname>Spoofchecker</classname>
    </simpara>
   </listitem>
  </itemizedlist>
 </section>

 <section xml:id="migration54.methods">
  <title>Новые методы</title>
  <simpara>
   Некоторые новые методы были введены в  5.4.0:
  </simpara>
  <simpara><link linkend="book.xsl">XSL</link>:</simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <methodname>XsltProcessor::setSecurityPrefs</methodname>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <methodname>XsltProcessor::getSecurityPrefs</methodname>
    </simpara>
   </listitem>
  </itemizedlist>
  <simpara><link linkend="book.spl">SPL</link>:</simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <methodname>RegexIterator::getRegex</methodname>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <methodname>SplObjectStorage::getHash</methodname>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <methodname>DirectoryIterator::getExtension</methodname>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <methodname>SplDoublyLinkedList::serialize</methodname>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <methodname>SplDoublyLinkedList::unserialize</methodname>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <methodname>SplFileInfo::getExtension</methodname>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <methodname>SplFileObject::fputcsv</methodname>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <methodname>SplQueue::serialize</methodname>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <methodname>SplQueue::unserialize</methodname>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <methodname>SplStack::serialize</methodname>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <methodname>SplStack::unserialize</methodname>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <methodname>SplTempFileObject::fputcsv</methodname>
    </simpara>
   </listitem>
  </itemizedlist>
  <simpara><link linkend="book.reflection">Reflection</link>:</simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <methodname>ReflectionExtension::isPersistent</methodname>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <methodname>ReflectionExtension::isTemporary</methodname>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <methodname>ReflectionClass::isCloneable</methodname>
    </simpara>
   </listitem>
  </itemizedlist>
  <simpara><classname>Closure</classname>:</simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <methodname>Closure::bind</methodname>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <methodname>Closure::bindTo</methodname>
    </simpara>
   </listitem>
  </itemizedlist>
  <simpara><link linkend="ref.pdo-dblib">PDO_dblib</link>:</simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <methodname>PDO::newRowset</methodname>
    </simpara>
   </listitem>
  </itemizedlist>
  <simpara><classname>StreamWrapper</classname>:</simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <methodname>StreamWrapper::stream_metadata</methodname>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <methodname>StreamWrapper::stream_truncate</methodname>
    </simpara>
   </listitem>
  </itemizedlist>
 </section>

 <section xml:id="migration54.removed-extensions">
  <title>Удаленные расширения</title>
  <simpara>
   Следующие расширения перемещены в репозиторий PECL и более не будут поставляться
   с дистрибутивом PHP. Версии этих расширений в виде пакетов PECL будут создаваться
   в соответствии с потребностями пользователей.
  </simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <link linkend="book.sqlite">sqlite</link>
     Обратите внимание, что расширения ext/sqlite3 и ext/pdo_sqlite остаются нетронутыми.
    </simpara>
   </listitem>
  </itemizedlist>
 </section>

 <section xml:id="migration54.extensions-other">
  <title>Другие изменения в расширениях</title>
  <simpara>
   Изменения в расширениях и новые возможности:
  </simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <link linkend="book.mysqli">mysqli</link>
     - <classname>mysqli_result</classname> теперь реализует класс <link linkend="class.traversable">Traversable</link>
    </simpara>
   </listitem>
  </itemizedlist>
  <itemizedlist>
   <listitem>
    <simpara>
     <link linkend="ref.pdo-mysql">pdo_mysql</link>
     - Удалена поддержка возможности сборки с клиентскими библиотеками MySQL старше версии 4.1.
    </simpara>
   </listitem>
  </itemizedlist>
  <itemizedlist>
   <listitem>
  <simpara>
   Расширения <link linkend="book.mysql">mysql</link>,
   <link linkend="book.mysqli">mysqli</link> и <link linkend="ref.pdo-mysql">PDO_mysql</link>
   используют <link linkend="book.mysqlnd">mysqlnd</link> в качестве библиотеки по умолчанию. Все еще возможно использовать
   libmysql, указав путь в конфигурационных настройках.
    </simpara>
  </listitem>
  </itemizedlist>
  <itemizedlist>
   <listitem>
    <simpara>
     <link linkend="book.mysqlnd">mysqlnd</link>
     - Добавлена поддержка именованных каналов (named pipes).
    </simpara>
   </listitem>
  </itemizedlist>
 </section>

 <section xml:id="migration54.global-constants">
  <title>Новые глобальные константы</title>

  <simpara>Ядро PHP:</simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <constant>ENT_DISALLOWED</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>ENT_HTML401</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>ENT_HTML5</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>ENT_SUBSTITUTE</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>ENT_XML1</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>ENT_XHTML</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>IPPROTO_IP</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>IPPROTO_IPV6</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>IPV6_MULTICAST_HOPS</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>IPV6_MULTICAST_IF</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>IPV6_MULTICAST_LOOP</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>IP_MULTICAST_IF</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>IP_MULTICAST_LOOP</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>IP_MULTICAST_TTL</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>MCAST_JOIN_GROUP</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>MCAST_LEAVE_GROUP</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>MCAST_BLOCK_SOURCE</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>MCAST_UNBLOCK_SOURCE</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>MCAST_JOIN_SOURCE_GROUP</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>MCAST_LEAVE_SOURCE_GROUP</constant>
    </simpara>
   </listitem>
  </itemizedlist>

   <simpara><link linkend="book.curl">Curl</link>:</simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <constant>CURLOPT_MAX_RECV_SPEED_LARGE</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>CURLOPT_MAX_SEND_SPEED_LARGE</constant>
    </simpara>
   </listitem>
   </itemizedlist>

  <simpara><link linkend="book.libxml">LibXML</link>:</simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <constant>LIBXML_HTML_NODEFDTD</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>LIBXML_HTML_NOIMPLIED</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>LIBXML_PEDANTIC</constant>
    </simpara>
   </listitem>
   </itemizedlist>

   <simpara><link linkend="book.openssl">OpenSSL</link>:</simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <constant>OPENSSL_CIPHER_AES_128_CBC</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>OPENSSL_CIPHER_AES_192_CBC</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>OPENSSL_CIPHER_AES_256_CBC</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>OPENSSL_RAW_DATA</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>OPENSSL_ZERO_PADDING</constant>
    </simpara>
   </listitem>
   </itemizedlist>

  <simpara><link linkend="book.outcontrol">Буферизация вывода</link>:</simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <constant>PHP_OUTPUT_HANDLER_CLEAN</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>PHP_OUTPUT_HANDLER_CLEANABLE</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>PHP_OUTPUT_HANDLER_DISABLED</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>PHP_OUTPUT_HANDLER_FINAL</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>PHP_OUTPUT_HANDLER_FLUSH</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>PHP_OUTPUT_HANDLER_FLUSHABLE</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>PHP_OUTPUT_HANDLER_REMOVABLE</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>PHP_OUTPUT_HANDLER_STARTED</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>PHP_OUTPUT_HANDLER_STDFLAGS</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>PHP_OUTPUT_HANDLER_WRITE</constant>
    </simpara>
   </listitem>
   </itemizedlist>

   <simpara><link linkend="book.session">Сессии</link>:</simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <constant>PHP_SESSION_ACTIVE</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>PHP_SESSION_DISABLED</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>PHP_SESSION_NONE</constant>
    </simpara>
   </listitem>
   </itemizedlist>

   <simpara><link linkend="book.stream">Потоки</link>:</simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <constant>STREAM_META_ACCESS</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>STREAM_META_GROUP</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>STREAM_META_GROUP_NAME</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>STREAM_META_OWNER</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>STREAM_META_OWNER_NAME</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>STREAM_META_TOUCH</constant>
    </simpara>
   </listitem>
   </itemizedlist>

   <simpara><link linkend="book.zlib">Zlib</link>:</simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <constant>ZLIB_ENCODING_DEFLATE</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>ZLIB_ENCODING_GZIP</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>ZLIB_ENCODING_RAW</constant>
    </simpara>
   </listitem>
  </itemizedlist>

  <simpara><link linkend="book.intl">Intl</link>:</simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <constant>U_IDNA_DOMAIN_NAME_TOO_LONG_ERROR</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>IDNA_CHECK_BIDI</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>IDNA_CHECK_CONTEXTJ</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>IDNA_NONTRANSITIONAL_TO_ASCII</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>IDNA_NONTRANSITIONAL_TO_UNICODE</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>INTL_IDNA_VARIANT_2003</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>INTL_IDNA_VARIANT_UTS46</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>IDNA_ERROR_EMPTY_LABEL</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>IDNA_ERROR_LABEL_TOO_LONG</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>IDNA_ERROR_DOMAIN_NAME_TOO_LONG</constant>
    </simpara>
   </listitem>
   <listitem>
   <simpara>
     <constant>IDNA_ERROR_LEADING_HYPHEN</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>IDNA_ERROR_TRAILING_HYPHEN</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>IDNA_ERROR_HYPHEN_3_4</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>IDNA_ERROR_LEADING_COMBINING_MARK</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>IDNA_ERROR_DISALLOWED</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>IDNA_ERROR_PUNYCODE</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>IDNA_ERROR_LABEL_HAS_DOT</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>IDNA_ERROR_INVALID_ACE_LABEL</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>IDNA_ERROR_BIDI</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>IDNA_ERROR_CONTEXTJ</constant>
    </simpara>
   </listitem>
  </itemizedlist>

  <simpara><link linkend="book.json">Json</link>:</simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <constant>JSON_PRETTY_PRINT</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>JSON_UNESCAPED_SLASHES</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>JSON_NUMERIC_CHECK</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>JSON_UNESCAPED_UNICODE</constant>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>JSON_BIGINT_AS_STRING</constant>
    </simpara>
   </listitem>
  </itemizedlist>
 </section>

 <section xml:id="migration54.ini">
  <title>Изменения в обработке INI-файлов</title>
  <simpara>
   Следующие &php.ini; директивы были удалены:
  </simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <link linkend="ini.register-globals">register_globals</link> и
     <link linkend="ini.register-long-arrays">register_long_arrays</link>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <link linkend="ini.magic-quotes-gpc">magic_quotes_gpc</link>,
     <link linkend="ini.magic-quotes-runtime">magic_quotes_runtime</link>
     и <link linkend="ini.magic-quotes-sybase">magic_quotes_sybase</link>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <link linkend="ini.allow-call-time-pass-reference">allow_call_time_pass_reference</link>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <link linkend="ini.define-syslog-variables">define_syslog_variables</link>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <link linkend="ini.syntax-highlighting">highlight.bg</link>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <link linkend="ini.session.bug-compat-42">session.bug_compat_42</link> и
     <link linkend="ini.session.bug-compat-warn">session.bug_compat_warn</link>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <link linkend="ini.y2k-compliance">y2k_compliance</link>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <link linkend="ini.safe-mode">safe_mode</link>,
     <link linkend="ini.safe-mode-gid">safe_mode_gid</link>,
     <link linkend="ini.safe-mode-include-dir">safe_mode_include_dir</link>,
     <link linkend="ini.safe-mode-exec-dir">safe_mode_exec_dir</link>,
     <link linkend="ini.safe-mode-allowed-env-vars">safe_mode_allowed_env_vars</link> и
     <link linkend="ini.safe-mode-protected-env-vars">safe_mode_protected_env_vars</link>
    </simpara>
   </listitem>
  </itemizedlist>
  <simpara>
   Следующие &php.ini; директивы были добавлены:
  </simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <link linkend="ini.cli.pager">cli.pager</link> и
     <link linkend="ini.cli.prompt">cli.prompt</link> для CLI SAPI, используя функцию readline
     в интерактивном режиме.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <link linkend="ini.cli-server.color">cli_server.color</link>
     для включения ANSI-раскраски в консольном выводе встроенного
     веб-сервера для разработки.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <link linkend="ini.max-input-vars">max_input_vars</link>
     - указывает, какое количество входных переменных GET/POST/COOKIE может быть принято.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <link linkend="ini.zend.multibyte">zend.multibyte</link>
     - для управления новой возможностью автоопределения закодированных Unicode скриптов и файлов.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <link linkend="ini.zend.script-encoding">zend.script_encoding</link>
     - Это значение будет использоваться до тех пор, пока не встретится
     директива "declare(encoding=...)" в начале скрипта.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <link linkend="ini.zend.signal-check">zend.signal_check</link>
     - для проверки замененных обработчиков сигналов при завершении.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <link linkend="ini.session.upload-progress.enabled">session.upload_progress.enabled</link>,
     <link linkend="ini.session.upload-progress.cleanup">session.upload_progress.cleanup</link>,
     <link linkend="ini.session.upload-progress.prefix">session.upload_progress.prefix</link>,
     <link linkend="ini.session.upload-progress.name">session.upload_progress.name</link>,
     <link linkend="ini.session.upload-progress.freq">session.upload_progress.freq</link>,
     <link linkend="ini.session.upload-progress.min-freq">session.upload_progress.min_freq</link>
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <link linkend="ini.enable-post-data-reading">enable_post_data_reading</link>
     - Когда отключено, данные POST не читаются (и не обрабатываются)
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <link linkend="ini.windows-show-crt-warning">windows_show_crt_warning</link>
     - Эта директива включает отображение предупреждений Windows CRT. До этого момента
     отображение было включено по умолчанию.
    </simpara>
   </listitem>
   </itemizedlist>
  <simpara>
   Следующие &php.ini; директивы были изменены:
  </simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     <link linkend="ini.session.entropy-file">session.entropy_file</link>
     теперь принимает значение по умолчанию /dev/random или /dev/urandom в зависимости от
     того, что было определено на этапе компиляции.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <link linkend="ini.session.entropy-length">session.entropy_length</link>
     теперь принимает значение по умолчанию 32.
    </simpara>
   </listitem>
   </itemizedlist>
 </section>

 <section xml:id="migration54.other">
  <title>Другие изменения</title>
  <itemizedlist>
   <listitem>
    <simpara>
     Кодировкой по умолчанию для функций <function>htmlspecialchars</function>
     и <function>htmlentities</function> сейчас является <literal>UTF-8</literal>,
     вместо прежней <literal>ISO-8859-1</literal>. Обратите внимание, что изменения кодировки вывода
     с помощью конфигурационной опции <link linkend="ini.default-charset">default_charset</link>
     не действует на вышеупомянутые функции до тех пор, пока вы
     не передадите "" (пустую строку) в качестве параметра кодировки в вызовы функций
     <function>htmlspecialchars</function>/<function>htmlentities</function>.
     В целом, мы не рекомендуем так делать, потому что вы должны иметь возможность
     изменить кодировку вывода без воздействия на кодировку во время исполнения, используемую
     этими функциями. Самый безопасный подход - явно установить кодировку при каждом
     вызове функций <function>htmlspecialchars</function> и
     <function>htmlentities</function>.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <constant>E_ALL</constant> теперь включает ошибки уровня <constant>E_STRICT</constant> в конфигурационной
     директиве <link linkend="ini.error-reporting">error_reporting</link>.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     У <link linkend="book.snmp">SNMP</link> теперь есть объектно-ориентированный API.
    </simpara>
    <simpara>
      Функции теперь возвращают &false; на каждую ошибку, включая относящиеся к SNMP.
      (Нет такого экземпляра, конец MIB и т.д.). Таким образом, в частности, изменяется предыдущее
      поведение функций get/walk, которые возвращали пустую строку при ошибках, относящихся к SNMP.
    </simpara>
    <simpara>
      Теперь поддерживаются множественные запросы OID get/getnext/set.
    </simpara>
    <simpara>
     Исключен код совместимости с UCD-SNMP, учитывая что обновление до net-snmp v5.3+, Net-SNMP v5.4+ является
     необходимым для версии под Windows.
    </simpara>
    <simpara>
     Ради добавления поддержки IPv6 разрешение DNS имен в удаленном SNMP агенте теперь
     выполнено с помощью расширения, а не через библиотеку Net-SNMP.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <link linkend="book.openssl">OpenSSL</link> теперь поддерживает AES.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <link linkend="features.commandline">CLI SAPI</link> теперь больше не прерывает работу
     при фатальных ошибках, когда используется интерактивный режим с поддержкой readline.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     Переменная <link linkend="language.variables.superglobals">$_SERVER['REQUEST_TIME_FLOAT']</link>
     была добавлена и содержит время с точностью до микросекунд.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     Добавлены новые хэш-алгоритмы: fnv132, fnv164, joaat
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     Теперь работает задание смещений в строке последовательно, например: $a[0][0], где $a - строка.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     Преобразование массивов из <type>SimpleXMLElement</type> теперь всегда содержит все узлы вместо
     только первого подходящего узла. Теперь выводятся все потомки <type>SimpleXMLElement</type>
     при использовании функций <function>var_dump</function>, <function>var_export</function> и
     <function>print_r</function>.
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     Стало актуальным требование присутствия аргументов абстрактного конструктора класса <link linkend="language.oop5.decon">__construct</link>
     в базовом классе при наследовании.
    </simpara>
   </listitem>
  </itemizedlist>
 </section>
</appendix>

<!-- Keep this comment at the end of the file
Local variables:
mode: sgml
sgml-omittag:t
sgml-shorttag:t
sgml-minimize-attributes:nil
sgml-always-quote-attributes:t
sgml-indent-step:1
sgml-indent-data:t
indent-tabs-mode:nil
sgml-parent-document:nil
sgml-default-dtd-file:"~/.phpdoc/manual.ced"
sgml-exposed-tags:nil
sgml-local-catalogs:nil
sgml-local-ecat-files:nil
End:
vim600: syn=xml fen fdm=syntax fdl=2 si
vim: et tw=78 syn=sgml
vi: ts=1 sw=1
-->
