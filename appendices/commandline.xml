<?xml version="1.0" encoding="windows-1251"?>
<!-- $Revision: 1.2 $ -->
<!--
   TODO:

     The command line options not in the
     list, but in the -h output below:

       -f, -e, -z, -l

     It would be best to document these, and
     collect more info about -c and -d!
-->
<appendix id="commandline">
 <title>Использование PHP из командной строки</title>
 <para>
  Параметры командной строки для PHP полезны, если вам
  нужно отладить или протестировать настройки PHP, но
  также они могут быть удобны и в том случае, если вы
  решите использовать PHP в других целях, нежели написание
  скриптов для web.
 </para>
 <para>
  Заметьте, что вы всегда можете направить вывод PHP
  во внешний файл с использованием символа &gt;, так что
  <literal>php -q test.php > test.html</literal> выведет
  результаты выполнения скрипта <filename>test.php</filename>
  без HTTP-заголовков в файл <filename>test.html</filename>
  в том же каталоге.
 </para>
 <para>
  Вы можете использовать параметры командной строки только
  в том случае, если ваш PHP является самостоятельным приложением.
  Если вы собрали модульную версию для сервера, причем
  если на вашей машине отсутствует CGI, вы не можете
  использовать эти параметры. Для пользователей Windows
  один файл <filename>php.exe</filename> может использоваться
  как в качестве самостоятельного приложения, так и в качестве
  серверного модуля.
 </para>
 <para>
  Этот список параметров командной строки соответствует PHP 4.0.6.
  Вы можете получить их действительный список с краткими однострочными
  описаниями, используя параметр <literal>-h</literal>. Результат
  выполнения команды <literal>php -h</literal> может быть приблизительно таким:
  <screen>
<![CDATA[
Usage: php [-q] [-h] [-s [-v] [-i] [-f <file>] |  {<file> [args...]}
  -q             Quiet-mode.  Suppress HTTP Header output.
  -s             Display colour syntax highlighted source.
  -f <file>      Parse <file>.  Implies `-q'
  -v             Version number
  -C             Do not chdir to the script's directory
  -c <path>      Look for php.ini file in this directory
  -d foo[=bar]   Define INI entry foo with value 'bar'
  -e             Generate extended information for debugger/profiler
  -z <file>      Load Zend extension <file>.
  -l             Syntax check only (lint)
  -m             Show compiled in modules
  -i             PHP information
  -h             This help
]]>
  </screen>
 </para>
 <para>
  Ниже приведен список наиболее значимых параметров командной
  строки с подробными описаниями.
 </para>
 <para>
  <table>
   <title>Параметры командной строки</title>
   <tgroup cols="2">
    <thead>
     <row>
      <entry>Параметр</entry>
      <entry>Описание</entry>
     </row>
    </thead>
    <tbody>
     <row>
      <entry>-q</entry>
      <entry>
       Запрещает вывод HTTP-заголовков. Обычно PHP выводит
       HTTP-заголовки по вызову программы (например, web-сервера)
       для последующей передачи их броузеру. В случае
       создания приложения, вызываемого из командной строки,
       необходимость в этих заголовках отсутствует.
      </entry>
     </row>
     <row>
      <entry>-s</entry>
      <entry>
       Выводит исходный код скрипта, выделенный цветом.
       Этот параметр равнозначен использованию функции
       <function>highlight_file</function> в скрипте PHP.
      </entry>
     </row>
     <row>
      <entry>-v</entry>
      <entry>
       Передавая PHP этот параметр, вы можете узнать
       текущую версию PHP, например, 4.0.6.
      </entry>
     </row>
     <row>
      <entry>-C</entry>
      <entry>
       Обычно PHP изменяет рабочий каталог на каталог
       с выполняемыми скрптами. Это дает возможность,
       например, открытия файлов, расположенных в одном
       каталоге со скриптом, путем указания только их
       имени. Если вы хотите отключить эту возможность смены
       каталогов, используйте этот параметр.
       this option.
      </entry>
     </row>
     <row>
      <entry>-c</entry>
      <entry>
       Используя этот параметр, вы можете указать альтернативный
       путь к файлу <filename>php.ini</filename> с тем, чтобы
       PHP обращался к конфигурационному файлу в указанном вами
       каталоге вместо каталога по умолчанию.
      </entry>
     </row>
     <row>
      <entry>-d</entry>
      <entry>
       С помощью этого параметра вы можете изменять
       отдельные настройки в файле <filename>php.ini</filename> 
       во время выполнения скрипта.
      </entry>
     </row>
     <row>
      <entry>-m</entry>
      <entry>
       С указанием этого параметра PHP выводит информацию
       о встроенных (и загруженных) модулях PHP и Zend,
       их версии и короткое замечание о принадлежности
       авторских прав на Zend.
      </entry>
     </row>
     <row>
      <entry>-i</entry>
      <entry>
       Этот параметр вызывает функцию <function>phpinfo</function> 
       и выводит результат ее выполнения. Если PHP не работает так,
       как нужно, выполните <literal>php -i</literal> и посмотрите,
       не ли в выведенной информации сообщений об ошибках.
      </entry>
     </row>
     <row>
      <entry>-h</entry>
      <entry>
       С помощью этого параметра вы можете получить список
       доступных параметров с их краткими однострочными описаниями.
      </entry>
     </row>
    </tbody>
   </tgroup>
  </table>
 </para>
 <para>
  PHP в виде самостоятельного приложения может использоваться
  для запуска скриптов PHP совершенно независимо от web-сервера.
  Если вы работаете с платформой Unix, вы должны добавить
  специальную строку в начало скрипта и пометить его как исполняемый,
  чтобы дать системе знать, какая программа ответственна за
  выполнение скрипта. На платформе Windows, вы можете установить
  связь между <literal>php.exe -q</literal> и <literal>.php</literal> файлами
  путем двойного щелчка на них, либо вы можете создать bat-файл для
  запуска скрипта с помощью PHP. Первая строка, добавляемая
  в скрипт на платформах Unix, игнорируется PHP на Windows-платформах,
  таким образом, вы можете создавать кроссплатформенные приложения.
  Пример программы PHP, выполняемой из командной строки, приведен ниже.
 </para>
 <example>
  <title>Скрипт, предназначенный для запуска из командной строки (script.php)</title>
  <programlisting role="php">
<![CDATA[
#!/usr/bin/php -q
<?php

if ($argc != 2 || in_array($argv[1], array('--help', '-help', '-h', '-?'))) {
?>

Это скрипт PHP, выполняемый из командной строки, использующий один параметр.

  Использование:
  <?php echo $argv[0]; ?> <параметр>

  <параметр> может принимать любое значение.
  С параметром --help, -help, -h, или -? вы можете
  получить справку.

<?php
} else {
    echo $argv[1];
}
?>
]]>
  </programlisting>
 </example>
 <para>
  В вышеприведенном скрипте была использована специальная первая строка
  с целью указания, что этот файл должен быть запущен с помощью PHP
  без вывода HTTP-заголовков. Существуют две переменных, которые
  вы можете использовать в процессе написания приложений PHP, выполняемых
  из командной строки: <varname>$argc</varname> и <varname>$argv</varname>.
  В первой содержится количество переданных приложению аргументов плюс
  один (имя выполняемого скрипта). Вторая переменная является массивом,
  содержащим собственно аргументы, начиная с имени скрипта с нулевым
  индексом (<varname>$argv[0]</varname>).
 </para>
 <para>
  В вышеприведенной программе проверялось условие отличия количества
  переданных аргументов от единицы. Также, если переданный аргумент
  был равен <literal>--help</literal>, <literal>-help</literal>,
  <literal>-h</literal> или <literal>-?</literal>, программа выдавала
  справочное сообщение. Если программе передавался какой-либо другой
  аргумент, он отображался на устройстве вывода.
 </para>
 <para>
  Если вы хотите запустить вышеприведенный скрипт на Unix, вы
  должны пометить его как исполнимый и вызвать его как
  <literal>script.php echothis</literal> или
  <literal>script.php -h</literal>. В Windows вы можете создать
  bat-файл для выполнения этого скрипта:
 </para>
 <example>
  <title>Bat-файл для запуска скрипта PHP из командной строки (script.bat)</title>
  <programlisting role="winbat">
@c:\php\php.exe -q script.php %1 %2 %3 %4
  </programlisting>
 </example>
 <para>
  Учитывая, что вы назвали вышеприведенную программу как
  <filename>script.php</filename> и исполняемый файл
  <filename>php.exe</filename> имеет полное имя
  <filename>c:\php\php.exe</filename>, этот bat-файл
  выполнит скрипт с дополнительными параметрами:
  <literal>script.bat echothis</literal> или
  <literal>script.bat -h</literal>.
 </para>
</appendix>

<!-- Keep this comment at the end of the file
Local variables:
mode: sgml
sgml-omittag:t
sgml-shorttag:t
sgml-minimize-attributes:nil
sgml-always-quote-attributes:t
sgml-indent-step:1
sgml-indent-data:t
indent-tabs-mode:nil
sgml-parent-document:nil
sgml-default-dtd-file:"../../manual.ced"
sgml-exposed-tags:nil
sgml-local-catalogs:nil
sgml-local-ecat-files:nil
End:
vim600: syn=xml fen fdm=syntax fdl=2 si
vim: et tw=78 syn=sgml
vi: ts=1 sw=1
-->
