<?xml version="1.0" encoding="utf-8"?>
<!-- EN-Revision: 6b48f364497107ae46f926bfc99a4e3d9d546316 Maintainer: sergey Status: ready -->
<!-- Reviewed: no -->
<sect1 xml:id="migration85.other-changes">
 <title>Другие изменения</title>

 <sect2 xml:id="migration85.other-changes.core">
  <title>Изменения в ядре</title>

  <sect3 xml:id="migration85.other-changes.core.core">
   <title>Ядро PHP</title>

   <simpara>
    Время высокого разрешения (<function>hrtime</function>) в macOS теперь
    использует рекомендуемый
    <code>clock_gettime_nsec_np(CLOCK_UPTIME_RAW)</code> API вместо
    <code>mach_absolute_time()</code>.
   </simpara>

  </sect3>

  <sect3 xml:id="migration85.other-changes.core.cgi-cli">
   <title>CGI/CLI</title>

   <simpara>
    Опция <option>-z</option> или <option>--zend-extension</option> удалена,
    так как не функционировала.
    Вместо неё используйте <option>-d zend_extension=[path]</option>.
   </simpara>

  </sect3>

  <sect3 xml:id="migration85.other-changes.core.pdo-odbc">
   <title>PDO_ODBC</title>

   <simpara>
    Изменено поведение при извлечении данных из больших столбцов.
    Вместо извлечения блоков по 256 байт PDO_ODBC будет пытаться извлекать
    блоки большего размера; в настоящее время это размер страницы за вычетом
    накладных расходов на строку. Драйверы, которые возвращают
    SQL_NO_TOTAL в SQLGetData, также обрабатываются лучше.
   </simpara>

  </sect3>

 </sect2>

 <sect2 xml:id="migration85.other-changes.sapi">
  <title>Изменения в модулях SAPI</title>

  <sect3 xml:id="migration85.other-changes.sapi.cli">
   <title>CLI</title>

   <simpara>
    Попытка установить слишком длинное название процесса с помощью
    функции <function>cli_set_process_title</function>
    теперь приведёт к ошибке, а не к молчаливому усечению заданного названия.
   </simpara>

   <simpara>
    Добавлена новая опция <option>--ini=diff</option> для вывода INI-настройки,
    отличной от установленной по умолчанию.
   </simpara>

  </sect3>

  <sect3 xml:id="migration85.other-changes.sapi.fpm">
   <title>FPM</title>

   <simpara>
    FPM с httpd ProxyPass опционально декодирует полный путь к скрипту.
    Добавлена INI-настройка fastcgi.script_path_encoded,
    чтобы предотвратить обновлённое поведение.
   </simpara>

   <simpara>
    Ограничение журнала доступа FPM теперь учитывает
    значение <link linkend="log-limit">log_limit</link>.
   </simpara>

  </sect3>

 </sect2>

 <sect2 xml:id="migration85.other-changes.functions">
  <title>Изменённые функции</title>

  <sect3 xml:id="migration85.other-changes.functions.intl">
   <title>Функции интернационализации</title>

   <simpara>
    Функция <function>grapheme_extract</function> правильно присваивает
    значение <parameter>$next</parameter> при пропуске недопустимых начальных байтов.
    Ранее были случаи, когда значение параметра указывало на начало границы графема,
    а не на конец.
   </simpara>

   <simpara>
    Из сигнатуры функций <function>transliterator_get_error_code</function>,
    <function>transliterator_get_error_message</function>,
    <methodname>TransLiterator::getErrorCode</methodname> и
    <methodname>TransLiterator::getErrorMessage</methodname> убрано
    возвращаемое значение &false;.
    Возвращение значения &false; на самом деле никогда не было возможным.
   </simpara>

   <simpara>
    Следующие функции теперь поддерживают параметр <parameter>$locale</parameter>:
    <function>grapheme_strpos</function>,
    <function>grapheme_stripos</function>,
    <function>grapheme_strrpos</function>,
    <function>grapheme_strripos</function>,
    <function>grapheme_substr</function>,
    <function>grapheme_strstr</function> и
    <function>grapheme_stristr</function>.
   </simpara>

  </sect3>

  <sect3 xml:id="migration85.other-changes.functions.ldap">
   <title>Функции LDAP</title>

   <simpara>
    Функция <function>ldap_get_option</function> теперь принимает соединение
    &null;, как и функция <function>ldap_set_option</function>,
    чтобы обеспечить возможность извлечения глобальных опций.
   </simpara>

  </sect3>

  <sect3 xml:id="migration85.other-changes.functions.libxml">
   <title>Функции libxml</title>

   <simpara>
    Тип возвращаемого значения функции <function>libxml_set_external_entity_loader</function>
    изменён на <type>true</type>.
   </simpara>

  </sect3>

  <sect3 xml:id="migration85.other-changes.functions.openssl">
   <title>Функции OpenSSL</title>

   <simpara>
    Добавлен новый параметр <parameter>$digest_algo</parameter>
    функциям <function>openssl_public_encrypt</function> и
    <function>openssl_private_decrypt</function>,
    который позволяет указать алгоритм хеширования
    для заполнения OAEP.
   </simpara>

   <simpara>
    Добавлен новый параметр <parameter>$padding</parameter>
    функциям <function>openssl_sign</function> и
    <function>openssl_verify</function>,

    <function>openssl_sign</function> and <function>openssl_verify</function>
    have a new parameter <parameter>$padding</parameter>,
    который позволяет использовать более
    безопасную подкладку RSA PSS.
   </simpara>

   <simpara>
    Параметр <parameter>$cipher_algo</parameter> функции <function>openssl_cms_encrypt</function>
    может быть строкой с именем шифра.
    Это позволяет использовать больше алгоритмов, включая алгоритмы шифрования AES GCM для
    данных с авторизацией.
   </simpara>

  </sect3>

  <sect3 xml:id="migration85.other-changes.functions.pcntl">
   <title>Функции PCNTL</title>

   <simpara>
    Тип возвращаемого значения функции <function>pcntl_exec</function>
    изменён на <type>false</type>.
   </simpara>

   <simpara>
    Функция <function>pcntl_waitid</function> принимает дополнительный аргумент
    <parameter>resource_usage</parameter> для сбора различных платформенных
    метрик о дочернем процессе.
   </simpara>

  </sect3>

  <sect3 xml:id="migration85.other-changes.functions.pdo-pgsql">
   <title>Функции PDO_PGSQL</title>

   <simpara>
    Метод <methodname>Pdo\Pgsql::copyFromArray</methodname> теперь
    поддерживает входные данные типа <type>iterable</type>.
   </simpara>

   <simpara>
    Метод <methodname>Pdo\Pgsql::setAttribute</methodname> и
    <methodname>Pdo\Pgsql::prepare</methodname> поддерживают
    установку значения <constant>PDO::ATTR_PREFETCH</constant> в 0,
    что переводит систему в режим отложенной выборки.
    В этом режиме операторы не могут выполняться параллельно.
   </simpara>

  </sect3>

  <sect3 xml:id="migration85.other-changes.functions.pgsql">
   <title>Функции PostgreSQL</title>

   <simpara>
    Функция <function>pg_copy_from</function> теперь
    поддерживает входные данные типа <type>iterable</type>.
   </simpara>

   <simpara>
    Функция <function>pg_connect</function> проверяет,
    содержит ли аргумент <parameter>connection_string</parameter> нулевой байт.
   </simpara>

   <simpara>
    Функция <function>pg_close_stmt</function> проверяет,
    содержит ли аргумент <parameter>statement_name</parameter> нулевой байт.
   </simpara>

  </sect3>

  <sect3 xml:id="migration85.other-changes.functions.posix">
   <title>Функции POSIX</title>

   <simpara>
    Функция <function>posix_ttyname</function> устанавливает last_error
    в EBADF при обнаружении
    некорректного файлового дескриптора.
   </simpara>

   <simpara>
    Функция <function>posix_isatty</function> выдаёт ошибку уровня <constant>E_WARNING</constant>
    при обнаружении некорректного файлового дескриптора.
   </simpara>

   <simpara>
    Функция <function>posix_fpathconf</function> проверяет некорректные файловые дескрипторы,
    устанавливает last_error в EBADF и выдаёт ошибку уровня <constant>E_WARNING</constant>.
   </simpara>

  </sect3>

  <sect3 xml:id="migration85.other-changes.functions.reflection">
   <title>Функции интроспекции кода Reflection</title>

   <simpara>
    Вывод метода <methodname>ReflectionClass::__toString</methodname> для перечислений изменён,
    чтобы лучше показать, что класс является перечислением,
    а элементы перечисления являются именно элементами перечисления,
    а не обычными константами класса.
   </simpara>

   <simpara>
    Вывод метода <methodname>ReflectionProperty::__toString</methodname> для свойств с хуками изменён,
    чтобы указать, у каких хуков есть свойство, являются ли эти хуки окончательными
    и является ли свойство виртуальным.
    Это также влияет на вывод метода <methodname>ReflectionClass::__toString</methodname>,
    когда класс содержит свойства с хуками.
   </simpara>

  </sect3>

  <sect3 xml:id="migration85.other-changes.functions.sockets">
   <title>Функции Sockets</title>

   <simpara>
    Функции <function>socket_create</function>/<function>socket_bind</function>
    могут создавать сокеты семейства <constant>AF_PACKET</constant>.
   </simpara>

   <simpara>
    Функция <function>socket_getsockname</function> получает индекс интерфейса
    и его строковое представление с помощью сокета <constant>AF_PACKET</constant>.
   </simpara>

  </sect3>

  <sect3 xml:id="migration85.other-changes.functions.zlib">
   <title>Функции Zlib</title>

   <simpara>
    Параметр <parameter>$use_include_path</parameter> функций <function>gzfile</function>,
    <function>gzopen</function> и <function>readgzfile</function> изменён
    с целого числа (<type>int</type>) на логическое значение (<type>bool</type>).
   </simpara>

   <simpara>
    Функции <function>gzfile</function>,
    <function>gzopen</function> и <function>readgzfile</function>
    теперь учитывают контекст потока по умолчанию.
   </simpara>

  </sect3>

 </sect2>

 <sect2 xml:id="migration85.other-changes.extensions">
  <title>Другие изменения в модулях</title>

  <sect3 xml:id="migration85.other-changes.extensions.curl">
   <title>Модуль cURL</title>

   <simpara>
    Функция <function>curl_setopt</function> со
    значением опции <constant>CURLOPT_FOLLOWLOCATION</constant>
    больше рассматривается не как логическое значение, а как целое число для обработки
    <constant>CURLFOLLOW_OBEYCODE</constant> и <constant>CURLFOLLOW_FIRSTONLY</constant>.
   </simpara>

  </sect3>

  <sect3 xml:id="migration85.other-changes.extensions.fileinfo">
   <title>Модуль Fileinfo</title>

   <simpara>
    Обновлён файл с версии 5.45 до 5.46.
   </simpara>

   <simpara>
    Тип возвращаемого значения функции <function>finfo_close</function> был изменён на
    <type>true</type> вместо <type>bool</type>.
   </simpara>

  </sect3>

  <sect3 xml:id="migration85.other-changes.extensions.intl">
   <title>Модуль интернационализации</title>

   <simpara>
    Внутренний механизм ошибок Intl был модернизирован,
    чтобы более точно указывать, какой участок кода вызвал ту или иную ошибку.
    Кроме того, некоторые исключения ext/date теперь
    заключены в <classname>IntlException</classname>.
   </simpara>

  </sect3>

  <sect3 xml:id="migration85.other-changes.extensions.lexbor">
   <title>Модуль Lexbor</title>

   <simpara>
    Добавлен всегда включенный модуль lexbor. Он содержит библиотеку lexbor,
    которая была отделена от <link linkend="book.dom">ext/dom</link>
    для повторного использования в других модулях.
    Новый модуль не доступно напрямую пользователям.
   </simpara>

  </sect3>

  <sect3 xml:id="migration85.other-changes.extensions.opcache">
   <title>Модуль Opcache</title>

   <simpara>
    Модуль <link linkend="book.opcache">Opcache</link> теперь всегда
    встроен в бинарный файл PHP и всегда загружается.
    INI-директивы <link linkend="ini.opcache.enable">opcache.enable</link> и
    <link linkend="ini.opcache.enable-cli">opcache.enable_cli</link> по-прежнему соблюдаются.
   </simpara>

  </sect3>

  <sect3 xml:id="migration85.other-changes.extensions.pcre">
   <title>Модуль PCRE</title>

   <simpara>
    Обновлена библиотека pcre2lib с версии 10.44 до 10.46.
   </simpara>

  </sect3>

  <sect3 xml:id="migration85.other-changes.extensions.pdo-sqlite">
   <title>Модуль PDO_Sqlite</title>

   <simpara>
    Увеличена поддержка минимальной версии с 3.7.7 до 3.7.17.
   </simpara>

  </sect3>

  <sect3 xml:id="migration85.other-changes.extensions.readline">
   <title>Модуль Readline</title>

   <simpara>
    Тип возвращаемого значения функций <function>readline_add_history</function>,
    <function>readline_clear_history</function> и <function>readline_callback_handler_install</function>
    был изменён с <type>bool</type> на <type>true</type>.
   </simpara>

  </sect3>

  <sect3 xml:id="migration85.other-changes.extensions.reflection">
   <title>Модуль интроспекции кода Reflection</title>

   <simpara>
    Класс <classname>ReflectionConstant</classname> больше не является окончательным.
   </simpara>

  </sect3>

 </sect2>

 <sect2 xml:id="migration85.other-changes.ini">
  <title>Изменения обработки INI-файла</title>

  <sect3 xml:id="migration85.other-changes.ini.core">
   <title>Ядро PHP</title>

   <simpara>
    Добавлен параметр fatal_error_backtraces для управления тем,
    должны ли фатальные ошибки включать обратную трассировку.
   </simpara>

   <simpara>
    Добавлена INI-настройка max_memory_limit, доступная только при запуске,
    для управления максимальным значением memory_limit, которое может быть настроено
    при запуске или во время работы.
    Превышение значения выдаёт предупреждение, если не установлено значение -1,
    и устанавливает memory_limit в текущее значение max_memory_limit.
   </simpara>

  </sect3>

  <sect3 xml:id="migration85.other-changes.ini.opcache">
   <title>Модуль Opcache</title>

   <simpara>
    Добавлена опция opcache.file_cache_read_only для поддержки
    каталога <link linkend="ini.opcache.file-cache">opcache.file_cache</link>
    только для чтения, для использования с файловыми системами только для чтения
    (например, контейнерами Docker только для чтения).

    Лучше всего использовать с <literal>opcache.validate_timestamps=0</literal>,
    <literal>opcache.enable_file_override=1</literal> и <literal>opcache.file_cache_consistency_checks=0</literal>.
   </simpara>

   <note>
    <simpara>
     Кеш, сгенерированный с помощью другой сборки PHP, другого пути к файлу
     или других настроек (включая загружаемые модули), может быть проигнорирован.
    </simpara>
   </note>

   <simpara>
    Значение по умолчанию <link linkend="ini.opcache.jit-hot-loop">opcache.jit_hot_loop</link>
    теперь 61 (простое число), чтобы предотвратить его кратность количеству итераций цикла.
    Рекомендуется устанавливать для этого параметра простое число.
   </simpara>

   <simpara>
    Изменение <link linkend="ini.opcache.memory-consumption">opcache.memory_consumption</link>
    при уже настроенном OPcache SHM теперь будет правильно сообщать об ошибке,
    а не молчаливо ничего не делать и показывать в PHPInfo вводящие в заблуждение значения.
   </simpara>

  </sect3>

  <sect3 xml:id="migration85.other-changes.ini.openssl">
   <title>Модуль OpenSSL</title>

   <simpara>
    Добавлена опция openssl.libctx для выбора типа контекста библиотеки OpenSSL.
    Можно использовать либо настраиваемый libctx для каждого потока,
    либо один глобальный (по умолчанию) libctx.
   </simpara>

  </sect3>

 </sect2>

 <sect2 xml:id="migration85.other-changes.performance">
  <title>Производительность</title>

  <sect3 xml:id="migration85.other-changes.performance.core">
   <title>Ядро PHP</title>

   <simpara>
    Удалены OP-коды для сравнения идентичности с логическими значениями,
    в частности для шаблона <code>match(true)</code>.
   </simpara>

   <simpara>
    Добавлена специализация OPcode для сравнений
    <code>=== []</code> и <code>!== []</code>.
   </simpara>

   <simpara>
    Создание объектов исключений теперь происходит намного быстрее.
   </simpara>

   <simpara>
    Части кода, в которых использовался SSE2,
    были адаптированы для использования SIMD с ARM NEON.
   </simpara>

   <simpara>
    Введена виртуальная машина TAILCALL, включенная по умолчанию при компиляции
    с Clang>=19 на x86_64 или aarch64. Виртуальная машина TAILCALL работает так же быстро,
    как виртуальная машина HYBRID, используемая при компиляции с GCC.
    Благодаря этому бинарные файлы PHP, скомпилированные с Clang>=19, работают так же быстро,
    как бинарные файлы, скомпилированные с GCC.
    Производительность виртуальной машины CALL, используемой с другими компиляторами,
    также значительно улучшилась.
   </simpara>

  </sect3>

  <sect3 xml:id="migration85.other-changes.performance.intl">
   <title>Модуль интернационализации</title>

   <simpara>
    Теперь не создаются лишние копии строк при
    преобразовании строк для использования в сортировщике.
   </simpara>

  </sect3>

  <sect3 xml:id="migration85.other-changes.performance.mbstring">
   <title>Модуль MBString</title>

   <simpara>
    Части кода, в которых использовался SSE2,
    были адаптированы для использования SIMD с ARM NEON.
   </simpara>

  </sect3>

  <sect3 xml:id="migration85.other-changes.performance.opcache">
   <title>Модуль Opcache</title>

   <simpara>
    Улучшена производительность извлечения переменных TLS в коде JIT в сборках без Glibc.
   </simpara>

  </sect3>

  <sect3 xml:id="migration85.other-changes.performance.reflection">
   <title>Модуль интроспекции кода Reflection</title>

   <para>
    Улучшена производительность следующих методов:
    <simplelist>
     <member><methodname>ReflectionProperty::getValue</methodname></member>
     <member><methodname>ReflectionProperty::getRawValue</methodname></member>
     <member><methodname>ReflectionProperty::isInitialized</methodname></member>
     <member><methodname>ReflectionProperty::isInitialized</methodname></member>
     <member><methodname>ReflectionProperty::setValue</methodname></member>
     <member><methodname>ReflectionProperty::setRawValue</methodname></member>
    </simplelist>
   </para>

  </sect3>

  <sect3 xml:id="migration85.other-changes.performance.spl">
   <title>Модуль SPL</title>

   <simpara>
    Улучшена производительность методов доступа к
    размерам и методов <classname>SplFixedArray</classname>.
   </simpara>

  </sect3>

  <sect3 xml:id="migration85.other-changes.performance.standard">
   <title>Стандартные модули</title>

   <simpara>
    Улучшенная производительность функций для работы с массивами с callback-функциями
    (<function>array_find</function>, <function>array_filter</function>,
    <function>array_map</function>, <function>usort</function>, ...).
   </simpara>

   <simpara>
    Улучшена производительность функций <function>urlencode</function> и
    <function>rawurlencode</function>.
   </simpara>

   <simpara>
    Улучшена производительность функции <function>unpack</function>
    с безымянными повторениями за счёт отказа от создания
    временных строк и их повторного анализа.
   </simpara>

   <simpara>
    Улучшена производительность функции <function>pack</function>.
   </simpara>

   <simpara>
    Незначительные улучшения производительности функции <function>array_chunk</function>.
   </simpara>

  </sect3>

  <sect3 xml:id="migration85.other-changes.performance.xml">
   <title>Модуль XML</title>

   <simpara>
    Улучшена производительность доступа к свойству класса <classname>XMLReader</classname>.
   </simpara>

   <simpara>
    Улучшена производительность класса <classname>XMLWriter</classname>
    и уменьшено потребление памяти.
   </simpara>

  </sect3>

 </sect2>

</sect1>
<!-- Keep this comment at the end of the file
Local variables:
mode: sgml
sgml-omittag:t
sgml-shorttag:t
sgml-minimize-attributes:nil
sgml-always-quote-attributes:t
sgml-indent-step:1
sgml-indent-data:t
indent-tabs-mode:nil
sgml-parent-document:nil
sgml-default-dtd-file:"~/.phpdoc/manual.ced"
sgml-exposed-tags:nil
sgml-local-catalogs:nil
sgml-local-ecat-files:nil
End:
vim600: syn=xml fen fdm=syntax fdl=2 si
vim: et tw=78 syn=sgml
vi: ts=1 sw=1
-->
